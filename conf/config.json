{
  "isArchive": false,     
  "pg": {
      "user": "webitel",
      "database": "webitel",
      "password": "webitel",
      "host": "10.10.10.200",
      "cdrTableA": "cdr_a",
      "cdrTableB": "cdr_b",
      "port": 5432
  },
  "broker":{
      "publisher": {
          "enable": true,
          "connectionString": "amqp://webitel:secret@10.10.10.200:5672?heartbeat=0",
          "exchangeName": "TAP.CDR-Events",
          "exchangeType": "direct",
          "routingKeyLegA": "cdr-leg-a",
          "routingKeyLegB": "cdr-leg-b",
          "bulkCount": 100,
          "intervalMillisec": 1000
      },
      "receiver": {
        "enable": false,
        "connectionString": "amqp://webitel:secret@10.10.10.200:5672?heartbeat=0",
        "exchangeName": "TAP.CDR-Events",
        "exchangeType": "direct",
        "routingKeyLegA": "cdr-leg-a",
        "routingKeyLegB": "cdr-leg-b",
        "bulkCount": 100,
        "intervalMillisec": 1000
      }
  },
  "elastic":{
      "enabled": true,
      "deleteTemplate": false,
      "host": "http://elasticsearch:9200",    
      "intervalMillisec": 1000,
      "bulkCount": 100,
      "indexName": "cdr",
      "typeName": "cdr",
      "template": {
          "name": "webitel",
          "body": {
            "index_patterns": ["cdr-*"],
            "order": 2,
            "mappings": {
              "cdr": {
                "dynamic_templates" : [
                  {
                    "string_fields" : {
                      "match_mapping_type": "*",
                      "match" : "*",
                      "mapping" : {
                        "type" : "keyword"
                      }
                    }
                  },
                  {
                    "integers": {
                      "match_mapping_type": "long",
                      "match" : "*",
                      "mapping": {
                        "type": "keyword"
                      }
                    }
                  },
                  {
                    "notanalyzed": {
                      "match": "*",
                      "mapping": {
                        "type": "keyword"
                      }
                    }
                  }
                ],                 
                "properties": {
                  "uuid": {
                    "type": "keyword"
                  },       
                  "direction": {
                    "type": "keyword"
                  },
                  "caller_id_name": {
                    "type": "keyword"
                  },
                  "caller_id_number": {
                    "type": "keyword"
                  },
                  "callee_id_name": {
                    "type": "keyword"
                  },
                  "callee_id_number": {
                    "type": "keyword"
                  },  
                  "network_addr": {
                    "type": "keyword"
                  }, 
                  "destination_number": {
                    "type": "keyword"
                  },      
                  "domain_name": {
                    "type": "keyword"
                  },
                  "extension": {
                    "type": "keyword"
                  },  
                  "presence_id": {
                    "type": "keyword"
                  }, 
                  "source": {
                    "type": "keyword"
                  }, 
                  "gateway": {
                    "type": "keyword"
                  }, 
                  "hangup_cause_q850": {
                    "type": "long"
                  },
                  "hangup_cause": {
                    "type": "keyword"
                  },
                  "originate_disposition": {
                    "type": "keyword"
                  },
                  "bridged_time": {
                    "type": "date"                                       
                  },
                  "answered_time": {
                    "type": "date"                                        
                  },
                  "progress_time": {
                    "type": "date"                                     
                  },
                  "hangup_time": {
                    "type": "date"                                       
                  },
                  "created_time": {
                    "type": "date"                                       
                  },  
                  "duration": {
                    "type": "long"
                  },                    
                  "billsec": {
                    "type": "long"
                  },      
                  "progresssec": {
                    "type": "long"
                  },     
                  "answersec": {
                    "type": "long"
                  },     
                  "waitsec": {
                    "type": "long"
                  },     
                  "holdsec": {
                    "type": "long"
                  }, 
                  "quality_percentage_audio": {
                    "type": "long"
                  },
                  "quality_percentage_video": {
                    "type": "long"
                  }, 
                  "locations": {
                    "type": "object",
                    "properties": {
                      "geo":{
                        "type": "keyword"
                      },
                      "city":{
                        "type": "keyword"
                      },
                      "country":{
                        "type": "keyword"
                      },
                      "country_code":{
                        "type": "keyword"
                      },
                      "type":{
                        "type": "keyword"
                      }
                    }
                  },
                  "queue":{
                    "type": "object",
                    "properties": {
                          "name": {
                          "type": "keyword"
                          },
                          "duration": {
                          "type": "long"
                          },
                          "wait_duration": {
                          "type": "long"
                          },
                          "cancel_reason": {
                          "type": "keyword"
                          },
                          "cause": {
                          "type": "keyword"
                          },
                          "answered_time": {
                          "type": "date"                          
                          },
                          "hangup_time": {
                          "type": "date"                          
                          },  
                          "joined_time": {
                          "type": "date"                          
                          },
                          "stop_side": {
                          "type": "keyword"
                          }   
                      }       
                  },                   
                  "variables": {
                    "type": "object",
                    "properties": {
                      "conference_member_id": {
                        "type": "long"
                      },  
                      "sip_invite_failure_status": {
                        "type": "long"
                      },
                      "video_read_rate": {
                        "type": "long"
                      },
                      "video_write_rate": {
                        "type": "long"
                      }       
                    }
                  }, 
                  "recordings": {
                    "type": "nested",
                    "include_in_parent": true,
                    "properties": {
                        "content-type": {
                          "type": "keyword"
                        },
                        "createdOn": {
                          "type": "date",
                          "format": "strict_date_optional_time||epoch_millis"
                        },
                        "domain": {
                          "type": "keyword"
                        },
                        "name": {
                          "type": "keyword"
                        },
                        "path": {
                          "type": "keyword"
                        },
                        "private": {
                          "type": "boolean",
                          "store": true
                        },
                        "size": {
                          "type": "long"
                        },
                        "type": {
                          "type": "integer"
                        },
                        "uuid": {
                          "type": "keyword"
                        }
                      }
                  },     
                  "callflow": {
                    "type": "nested",
                    "include_in_parent": true,                        
                    "properties": {
                      "caller_profile":{
                        "type":"object",
                        "properties": {
                          "username": {
                            "type": "keyword"
                          },
                          "caller_id_name": {
                            "type": "keyword"
                          },
                          "ani": {
                            "type": "keyword"
                          },
                          "aniii": {
                            "type": "keyword"
                          },
                          "caller_id_number": {
                            "type": "keyword"
                          },
                          "network_addr": {
                            "type": "keyword"
                          },
                          "rdnis": {
                            "type": "keyword"
                          },
                          "destination_number": {
                            "type": "keyword"
                          },
                          "uuid": {
                            "type": "keyword"
                          },
                          "source": {
                            "type": "keyword"
                          }
                        }
                      },
                      "times":{
                        "type":"object",
                        "properties": {
                          "created_time": {
                            "type": "date"                          
                          },
                          "profile_created_time": {
                            "type": "date"                          
                          },
                          "progress_time": {
                            "type": "date"                          
                          },
                          "progress_media_time": {
                            "type": "date"                          
                          },
                          "answered_time": {
                            "type": "date"                          
                          },
                          "bridged_time": {
                            "type": "date"                          
                          },
                          "last_hold_time": {
                            "type": "date"                          
                          },
                          "hold_accum_time": {
                            "type": "date"                          
                          },
                          "hangup_time": {
                            "type": "date"                          
                          },
                          "resurrect_time": {
                            "type": "date"                          
                          },
                          "transfer_time": {
                            "type": "date"                          
                          }
                        }
                      }
                    }
                  },   
                  "legs_b":{
                    "type": "nested",
                    "include_in_parent": true,                        
                    "properties": {
                      "uuid": {
                        "type": "keyword"
                      },       
                      "direction": {
                        "type": "keyword"
                      },
                      "caller_id_name": {
                        "type": "keyword",
                        "store": true
                      },
                      "caller_id_number": {
                        "type": "keyword"
                      },
                      "callee_id_name": {
                        "type": "keyword"
                      },
                      "callee_id_number": {
                        "type": "keyword"
                      },  
                      "network_addr": {
                        "type": "keyword"
                      }, 
                      "destination_number": {
                        "type": "keyword"
                      },      
                      "domain_name": {
                        "type": "keyword"
                      },
                      "extension": {
                        "type": "keyword"
                      },  
                      "presence_id": {
                        "type": "keyword"
                      }, 
                      "source": {
                        "type": "keyword"
                      }, 
                      "gateway": {
                        "type": "keyword"
                      }, 
                      "hangup_cause_q850": {
                        "type": "long"
                      },
                      "hangup_cause": {
                        "type": "keyword"
                      },
                      "originate_disposition": {
                        "type": "keyword"
                      },
                      "bridged_time": {
                        "type": "date"                     
                      },
                      "answered_time": {
                        "type": "date"                                         
                      },
                      "progress_time": {
                        "type": "date"                                           
                      },
                      "hangup_time": {
                        "type": "date"                                          
                      },
                      "created_time": {
                        "type": "date"                                        
                      },  
                      "duration": {
                        "type": "long"
                      },                    
                      "billsec": {
                        "type": "long"
                      },      
                      "progresssec": {
                        "type": "long"
                      },     
                      "answersec": {
                        "type": "long"
                      },     
                      "waitsec": {
                        "type": "long"
                      },     
                      "holdsec": {
                        "type": "long"
                      }, 
                      "quality_percentage_audio": {
                        "type": "long"
                      },
                      "quality_percentage_video": {
                        "type": "long"
                      }, 
                      "locations": {
                        "type": "object",
                        "properties": {
                          "geo":{
                            "type": "keyword"
                          },
                          "city":{
                            "type": "keyword"
                          },
                          "country":{
                            "type": "keyword"
                          },
                          "country_code":{
                            "type": "keyword"
                          },
                          "type":{
                            "type": "keyword"
                          }
                        }
                      },
                      "queue":{
                        "type": "object",
                        "properties": {
                              "name": {
                              "type": "keyword"
                              },
                              "duration": {
                              "type": "long"
                              },
                              "wait_duration": {
                              "type": "long"
                              },
                              "cancel_reason": {
                              "type": "keyword"
                              },
                              "cause": {
                              "type": "keyword"
                              },
                              "answered_time": {
                              "type": "date"                              
                              },
                              "hangup_time": {
                              "type": "date"                             
                              },  
                              "joined_time": {
                              "type": "date"                              
                              },
                              "stop_side": {
                              "type": "keyword"
                              }   
                          }       
                      },                   
                      "variables": {
                        "type": "object",
                        "properties": {
                          "conference_member_id": {
                            "type": "long"
                          },  
                          "sip_invite_failure_status": {
                            "type": "long"
                          },
                          "video_read_rate": {
                            "type": "long"
                          },
                          "video_write_rate": {
                            "type": "long"
                          }       
                        }
                      }  
                    }
                  }                                      
                }
              }
            }
          }
        }
  }   
}    
